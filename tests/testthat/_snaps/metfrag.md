# Do adducts affect MetFrag config generation correctly?

    Code
      cfconf
    Output
       [1] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M+H]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 1\nResultsPath = results\nPeakListPath = spec/sample_a_[M+H]+_a.csv\n\n"             
       [2] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M+NH4]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 18\nResultsPath = results\nPeakListPath = spec/sample_a_[M+NH4]+_a.csv\n\n"        
       [3] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M+Na]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 23\nResultsPath = results\nPeakListPath = spec/sample_a_[M+Na]+_a.csv\n\n"          
       [4] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M+K]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 39\nResultsPath = results\nPeakListPath = spec/sample_a_[M+K]+_a.csv\n\n"            
       [5] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M+CH3OH+H]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 33\nResultsPath = results\nPeakListPath = spec/sample_a_[M+CH3OH+H]+_a.csv\n\n"
       [6] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M+ACN+H]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 42\nResultsPath = results\nPeakListPath = spec/sample_a_[M+ACN+H]+_a.csv\n\n"    
       [7] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M+ACN+Na]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 64\nResultsPath = results\nPeakListPath = spec/sample_a_[M+ACN+Na]+_a.csv\n\n"  
       [8] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M+2ACN+H]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 83\nResultsPath = results\nPeakListPath = spec/sample_a_[M+2ACN+H]+_a.csv\n\n"  
       [9] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M-H]-_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = -1\nResultsPath = results\nPeakListPath = spec/sample_a_[M-H]-_a.csv\n\n"           
      [10] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M+Cl]-_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = 35\nResultsPath = results\nPeakListPath = spec/sample_a_[M+Cl]-_a.csv\n\n"         
      [11] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M+HCOO]-_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = 45\nResultsPath = results\nPeakListPath = spec/sample_a_[M+HCOO]-_a.csv\n\n"     
      [12] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M+CH3COO]-_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = 49\nResultsPath = results\nPeakListPath = spec/sample_a_[M+CH3COO]-_a.csv\n\n" 
      [13] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M+]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 0\nResultsPath = results\nPeakListPath = spec/sample_a_[M+]+_a.csv\n\n"               
      [14] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample_a_[M-]-_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = 0\nResultsPath = results\nPeakListPath = spec/sample_a_[M-]-_a.csv\n\n"              

# Function get_metfrag_targets behaves as expected.

    Code
      head(res, 5)
    Output
         adduct tag  ID CE   an   ion_mz       mz intensity
      1: [M+H]+  AA 100 10 5413 182.0816 60.30273  14530.50
      2: [M+H]+  AA 100 10 5413 182.0816 69.03477  14933.95
      3: [M+H]+  AA 100 10 5413 182.0816 72.08167  23162.33
      4: [M+H]+  AA 100 10 5413 182.0816 73.58591  15178.13
      5: [M+H]+  AA 100 10 5413 182.0816 84.21584  15690.25

---

    Code
      tail(res, 5)
    Output
         adduct tag  ID CE   an   ion_mz       mz intensity
      1: [M+H]+  WT 112 10 2838 268.1045 268.9995  5832.155
      2: [M+H]+  WT 112 10 2838 268.1045 269.0623 12559.663
      3: [M+H]+  WT 112 10 2838 268.1045 269.1075 25460.779
      4: [M+H]+  WT 112 10 2838 268.1045 269.1560  2797.057
      5: [M+H]+  WT 112 10 2838 268.1045 270.1093  2376.579

# function metfrag_on_state returns correct result.

    Code
      fc_i
    Output
      [1] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = testsample_[M+H]+_AA_100_10_5413\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 182.0816\nIsPositiveIonMode = True\nPrecursorIonMode = 1\nResultsPath = results\nPeakListPath = spec/testsample_[M+H]+_AA_100_10_5413.csv\n\n"

---

    Code
      fs_i
    Output
      [1] "60.3027267456055 14530.4990234375\n69.0347747802734 14933.9462890625\n72.081672668457 23162.328125\n73.5859069824219 15178.1337890625\n84.2158432006836 15690.2490234375\n85.029182434082 25554.4140625\n87.0445098876953 18821.197265625\n89.0607986450195 16427.841796875\n89.1210479736328 18217.8828125\n91.0549774169922 134823.34375\n95.0499801635742 65502.11328125\n97.2613983154297 14389.7861328125\n97.6495895385742 18860.0859375\n98.9850387573242 40601.94140625\n103.05541229248 22867.087890625\n107.049621582031 27537.53125\n109.065811157227 18192.5703125\n114.104202270508 28663.447265625\n114.111488342285 49196.390625\n119.049705505371 847674.0625\n119.070999145508 30140.04296875\n120.052658081055 81358.890625\n121.065406799316 54804.33203125\n123.044578552246 1926560\n124.047966003418 157123.359375\n127.015647888184 26872.388671875\n136.076065063477 7931134.5\n137.079635620117 706313.5625\n138.082427978516 27748.052734375\n139.123321533203 34180.078125\n147.044372558594 1259233\n148.047698974609 131880.265625\n165.055038452148 5622034\n166.05842590332 623428.3125\n167.060729980469 20126.279296875\n167.091812133789 22329.521484375\n182.081588745117 856551.0625\n182.190643310547 21733.291015625\n183.085632324219 91777.6015625\n183.149627685547 185449.015625\n184.153289794922 20294.25\n185.558090209961 22628.728515625\n204.384399414063 31079.345703125\n"

---

    Code
      fc_l
    Output
      [1] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = testsample_[M+H]+_KO_100_10_5434\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 182.0816\nIsPositiveIonMode = True\nPrecursorIonMode = 1\nResultsPath = results\nPeakListPath = spec/testsample_[M+H]+_KO_100_10_5434.csv\n\n"

---

    Code
      fs_l
    Output
      [1] "55.0188598632813 3557.97436523438\n55.0551605224609 2828.3818359375\n57.034553527832 13765.171875\n57.0708541870117 1948.08374023438\n57.1659469604492 1294.70715332031\n59.0502586364746 6707.33154296875\n60.0453071594238 2280.73193359375\n61.0294647216797 10715.017578125\n68.165412902832 1142.19506835938\n69.0345077514649 69053.140625\n70.0379028320313 1795.19860839844\n71.0501556396484 9510.4541015625\n72.0452346801758 1734.47155761719\n73.0293197631836 2689.95532226563\n73.065788269043 8034.94921875\n75.0449600219727 8084.9453125\n76.0398178100586 1468.29907226563\n81.0343551635742 4864.2607421875\n81.0707931518555 1732.8984375\n83.0500106811524 22246.251953125\n84.0452728271484 1727.80944824219\n85.0293273925781 42271.6171875\n86.0323944091797 3086.66723632813\n87.0448760986328 16722.26953125\n88.0402755737305 2417.91748046875\n89.060546875 15942.32421875\n90.0557708740234 3494.83618164063\n91.0398101806641 8827.8701171875\n91.0550689697266 2999.041015625\n93.0545349121094 1194.25952148438\n93.07080078125 1294.88610839844\n95.0501022338867 2660.26586914063\n95.0862503051758 2493.74291992188\n97.0291900634766 4663.837890625\n98.0607147216797 1322.10998535156\n98.9849700927734 40984.87890625\n99.0447998046875 11727.0556640625\n101.060676574707 2679.9345703125\n101.096702575684 3435.29125976563\n103.03978729248 11158.53125\n103.075958251953 1674.74304199219\n105.070327758789 1595.48498535156\n107.070823669434 8057.98388671875\n109.065361022949 1518.97705078125\n109.101905822754 1638.36547851563\n109.405807495117 1205.00219726563\n110.072074890137 1678.50036621094\n111.044761657715 24140.046875\n117.054695129395 1369.70556640625\n117.091796875 2421.29370117188\n119.049697875977 16888.525390625\n119.070739746094 8162.4892578125\n121.065284729004 4612.3271484375\n121.101821899414 1777.70166015625\n123.035430908203 1789.76208496094\n123.044593811035 34819.59375\n123.055351257324 4744.55517578125\n124.047988891602 2438.09399414063\n125.060935974121 1541.78198242188\n126.250373840332 1361.5244140625\n126.442039489746 1399.60339355469\n127.015960693359 30204.63671875\n127.039329528809 8304.6806640625\n129.055130004883 33418.078125\n131.070434570313 1761.48364257813\n135.012222290039 1908.33984375\n136.076080322266 143356.171875\n137.061340332031 1264.84484863281\n137.079620361328 15243.3076171875\n137.096588134766 3348.57373046875\n138.053924560547 1271.18615722656\n139.123443603516 1695.84375\n140.083526611328 1486.2216796875\n141.066513061523 1284.47790527344\n144.065872192383 2364.5400390625\n145.049682617188 6511.3193359375\n147.044479370117 26052.619140625\n147.065093994141 14748.5615234375\n148.04719543457 2680.55224609375\n149.08088684082 1496.30859375\n155.047012329102 14446.072265625\n155.107131958008 2343.6201171875\n162.076629638672 3849.05932617188\n163.132995605469 2855.625\n165.05500793457 99720.6875\n165.076019287109 13318.740234375\n165.091369628906 3072.4169921875\n166.058807373047 8357.986328125\n167.091888427734 5026.99609375\n179.046966552734 1596.17309570313\n180.068344116211 2513.84521484375\n180.086883544922 13910.0703125\n180.101852416992 1683.16101074219\n180.872436523438 1415.51440429688\n181.060562133789 3325.17578125\n181.089508056641 1909.15808105469\n181.108963012695 1384.07287597656\n181.122512817383 3012.08203125\n182.009887695313 6990.79443359375\n182.080902099609 16412.189453125\n182.11784362793 4357.50732421875\n182.190734863281 16766.787109375\n183.04133605957 1596.85913085938\n183.078674316406 4474.080078125\n183.100234985352 1810.49816894531\n183.11408996582 2864.93237304688\n183.194580078125 2266.71069335938\n184.097351074219 1749.04125976563\n"

