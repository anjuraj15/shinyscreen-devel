# Do adducts affect MetFrag config generation correctly?

    Code
      cfconf
    Output
       [1] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 1\nResultsPath = results/sample_a_[M+H]+_a.CSV\nPeakListPath = spec/sample_a_[M+H]+_a.csv\n"             
       [2] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 18\nResultsPath = results/sample_a_[M+NH4]+_a.CSV\nPeakListPath = spec/sample_a_[M+NH4]+_a.csv\n"        
       [3] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 23\nResultsPath = results/sample_a_[M+Na]+_a.CSV\nPeakListPath = spec/sample_a_[M+Na]+_a.csv\n"          
       [4] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 39\nResultsPath = results/sample_a_[M+K]+_a.CSV\nPeakListPath = spec/sample_a_[M+K]+_a.csv\n"            
       [5] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 33\nResultsPath = results/sample_a_[M+CH3OH+H]+_a.CSV\nPeakListPath = spec/sample_a_[M+CH3OH+H]+_a.csv\n"
       [6] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 42\nResultsPath = results/sample_a_[M+ACN+H]+_a.CSV\nPeakListPath = spec/sample_a_[M+ACN+H]+_a.csv\n"    
       [7] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 64\nResultsPath = results/sample_a_[M+ACN+Na]+_a.CSV\nPeakListPath = spec/sample_a_[M+ACN+Na]+_a.csv\n"  
       [8] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 83\nResultsPath = results/sample_a_[M+2ACN+H]+_a.CSV\nPeakListPath = spec/sample_a_[M+2ACN+H]+_a.csv\n"  
       [9] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = -1\nResultsPath = results/sample_a_[M-H]-_a.CSV\nPeakListPath = spec/sample_a_[M-H]-_a.csv\n"           
      [10] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = 35\nResultsPath = results/sample_a_[M+Cl]-_a.CSV\nPeakListPath = spec/sample_a_[M+Cl]-_a.csv\n"         
      [11] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = 45\nResultsPath = results/sample_a_[M+HCOO]-_a.CSV\nPeakListPath = spec/sample_a_[M+HCOO]-_a.csv\n"     
      [12] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = 49\nResultsPath = results/sample_a_[M+CH3COO]-_a.CSV\nPeakListPath = spec/sample_a_[M+CH3COO]-_a.csv\n" 
      [13] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 0\nResultsPath = results/sample_a_[M+]+_a.CSV\nPeakListPath = spec/sample_a_[M+]+_a.csv\n"               
      [14] "MetFragDatabaseType = \nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = sample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = 0\nResultsPath = results/sample_a_[M-]-_a.CSV\nPeakListPath = spec/sample_a_[M-]-_a.csv\n"              

# Function get_metfrag_targets behaves as expected.

    Code
      head(res, 5)
    Output
         adduct tag  ID CE   an   ion_mz       mz intensity
      1: [M+H]+  AA 100 10 5413 182.0816 60.30273  14530.50
      2: [M+H]+  AA 100 10 5413 182.0816 69.03477  14933.95
      3: [M+H]+  AA 100 10 5413 182.0816 72.08167  23162.33
      4: [M+H]+  AA 100 10 5413 182.0816 73.58591  15178.13
      5: [M+H]+  AA 100 10 5413 182.0816 84.21584  15690.25

---

    Code
      tail(res, 5)
    Output
         adduct tag  ID CE   an   ion_mz       mz intensity
      1: [M+H]+  WT 112 10 2838 268.1045 268.9995  5832.155
      2: [M+H]+  WT 112 10 2838 268.1045 269.0623 12559.663
      3: [M+H]+  WT 112 10 2838 268.1045 269.1075 25460.779
      4: [M+H]+  WT 112 10 2838 268.1045 269.1560  2797.057
      5: [M+H]+  WT 112 10 2838 268.1045 270.1093  2376.579

# function metfrag_on_state returns correct result.

    Code
      fc_i
    Output
      [1] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = testsample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 182.0816\nIsPositiveIonMode = True\nPrecursorIonMode = 1\nResultsPath = results/testsample_[M+H]+_AA_100_10_5413.CSV\nPeakListPath = spec/testsample_[M+H]+_AA_100_10_5413.csv\n"

---

    Code
      fs_i
    Output
      [1] "60.3027267456055 14530.4990234375\n69.0347747802734 14933.9462890625\n72.081672668457 23162.328125\n73.5859069824219 15178.1337890625\n84.2158432006836 15690.2490234375\n85.029182434082 25554.4140625\n87.0445098876953 18821.197265625\n89.0607986450195 16427.841796875\n89.1210479736328 18217.8828125\n91.0549774169922 134823.34375\n95.0499801635742 65502.11328125\n97.2613983154297 14389.7861328125\n97.6495895385742 18860.0859375\n98.9850387573242 40601.94140625\n103.05541229248 22867.087890625\n107.049621582031 27537.53125\n109.065811157227 18192.5703125\n114.104202270508 28663.447265625\n114.111488342285 49196.390625\n119.049705505371 847674.0625\n119.070999145508 30140.04296875\n120.052658081055 81358.890625\n121.065406799316 54804.33203125\n123.044578552246 1926560\n124.047966003418 157123.359375\n127.015647888184 26872.388671875\n136.076065063477 7931134.5\n137.079635620117 706313.5625\n138.082427978516 27748.052734375\n139.123321533203 34180.078125\n147.044372558594 1259233\n148.047698974609 131880.265625\n165.055038452148 5622034\n166.05842590332 623428.3125\n167.060729980469 20126.279296875\n167.091812133789 22329.521484375\n182.081588745117 856551.0625\n182.190643310547 21733.291015625\n183.085632324219 91777.6015625\n183.149627685547 185449.015625\n184.153289794922 20294.25\n185.558090209961 22628.728515625\n204.384399414063 31079.345703125\n"

---

    Code
      fc_l
    Output
      [1] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore\nMetFragScoreWeights = 1,1\nMetFragCandidateWriter = CSV\nSampleName = testsample\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter\nMetFragPreProcessingCandidateFilter = IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nIonizedPrecursorMass = 268.1045\nIsPositiveIonMode = True\nPrecursorIonMode = 1\nResultsPath = results/testsample_[M+H]+_WT_112_10_2838.CSV\nPeakListPath = spec/testsample_[M+H]+_WT_112_10_2838.csv\n"

---

    Code
      fs_l
    Output
      [1] "51.7032508850098 1125.56567382813\n56.7040748596191 1094.67370605469\n57.0346031188965 1427.85583496094\n59.0502052307129 18689.2265625\n60.0046081542969 1385.01477050781\n61.8894500732422 1086.67651367188\n67.5898284912109 1109.52416992188\n82.0690078735352 1130.2099609375\n87.0448837280273 1949.03173828125\n98.9849319458008 14717.2021484375\n101.06031036377 1812.59704589844\n103.03980255127 1550.00061035156\n104.070869445801 1979.544921875\n107.060447692871 1381.76489257813\n112.076278686523 1370.1689453125\n115.075790405273 6199.5634765625\n117.055374145508 5478.92138671875\n117.091590881348 18881.380859375\n118.0947265625 2666.72973632813\n133.050445556641 1348.02868652344\n133.086135864258 1907.083984375\n135.101623535156 1702.38220214844\n135.68879699707 1765.84252929688\n136.062118530273 252715.78125\n136.441772460938 2205.2294921875\n137.056549072266 1376.27136230469\n137.066558837891 11079.37109375\n155.046630859375 2328.61376953125\n156.101181030273 1567.44885253906\n159.082595825195 3139.30834960938\n167.766403198242 1253.03051757813\n175.133102416992 3932.71850585938\n191.091934204102 2672.03979492188\n195.101898193359 4810.875\n207.122497558594 1741.7646484375\n221.059326171875 2607.07641601563\n222.149154663086 1708.88696289063\n228.230590820313 1725.90649414063\n233.102767944336 8421.59765625\n249.054534912109 35018.57421875\n249.186981201172 1913.18981933594\n250.058181762695 4057.30712890625\n250.143905639648 2725.98022460938\n250.989196777344 4109.654296875\n251.185287475586 35405.00390625\n252.189514160156 3622.57421875\n253.128036499023 2947.4873046875\n260.434783935547 1568.28930664063\n266.079040527344 1580.90734863281\n267.06494140625 217966.890625\n268.068817138672 23908.1640625\n268.104278564453 203054.765625\n268.154083251953 10530.7392578125\n268.99951171875 5832.15478515625\n269.062255859375 12559.6630859375\n269.107452392578 25460.779296875\n269.156005859375 2797.05712890625\n270.109252929688 2376.57885742188\n"

