# Do adducts affect MetFrag config generation correctly?

    Code
      cfconf
    Output
       [1] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M+H]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 1\nResultsPath = results\nPeakListPath = spec/testsample_a_[M+H]+_a.csv\n\n"             
       [2] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M+NH4]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 18\nResultsPath = results\nPeakListPath = spec/testsample_a_[M+NH4]+_a.csv\n\n"        
       [3] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M+Na]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 23\nResultsPath = results\nPeakListPath = spec/testsample_a_[M+Na]+_a.csv\n\n"          
       [4] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M+K]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 39\nResultsPath = results\nPeakListPath = spec/testsample_a_[M+K]+_a.csv\n\n"            
       [5] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M+CH3OH+H]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 33\nResultsPath = results\nPeakListPath = spec/testsample_a_[M+CH3OH+H]+_a.csv\n\n"
       [6] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M+ACN+H]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 42\nResultsPath = results\nPeakListPath = spec/testsample_a_[M+ACN+H]+_a.csv\n\n"    
       [7] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M+ACN+Na]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 64\nResultsPath = results\nPeakListPath = spec/testsample_a_[M+ACN+Na]+_a.csv\n\n"  
       [8] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M+2ACN+H]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 83\nResultsPath = results\nPeakListPath = spec/testsample_a_[M+2ACN+H]+_a.csv\n\n"  
       [9] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M-H]-_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = -1\nResultsPath = results\nPeakListPath = spec/testsample_a_[M-H]-_a.csv\n\n"           
      [10] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M+Cl]-_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = 35\nResultsPath = results\nPeakListPath = spec/testsample_a_[M+Cl]-_a.csv\n\n"         
      [11] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M+HCOO]-_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = 45\nResultsPath = results\nPeakListPath = spec/testsample_a_[M+HCOO]-_a.csv\n\n"     
      [12] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M+CH3COO]-_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = 49\nResultsPath = results\nPeakListPath = spec/testsample_a_[M+CH3COO]-_a.csv\n\n" 
      [13] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M+]+_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = True\nPrecursorIonMode = 0\nResultsPath = results\nPeakListPath = spec/testsample_a_[M+]+_a.csv\n\n"               
      [14] "MetFragDatabaseType = LocalCSV\nFragmentPeakMatchAbsoluteMassDeviation = 0.001\nFragmentPeakMatchRelativeMassDeviation = 5\nDatabaseSearchRelativeMassDeviation = 5\nMetFragCandidateWriter = CSV\nSampleName = testsample_a_[M-]-_a\nMaximumTreeDepth = 2\nMetFragPreProcessingCandidateFilter = UnconnectedCompoundFilter,IsotopeFilter\nMetFragPostProcessingCandidateFilter = InChIKeyFilter\nMetFragScoreTypes = FragmenterScore,OfflineIndividualMoNAScore,PubMed_Count,Patent_Count,AnnoTypeCount\nMetFragScoreWeights = 1,1,1,1,1\nIonizedPrecursorMass = 777.7789\nIsPositiveIonMode = False\nPrecursorIonMode = 0\nResultsPath = results\nPeakListPath = spec/testsample_a_[M-]-_a.csv\n\n"              

# function metfrag_run returns correct result.

    Code
      ftab
    Output
          ID adduct tag   an CE
      1: 103 [M+H]+  WT 4656 10
      2: 105 [M+H]+  AA 5200 10
                                                                f_conf
      1: config/testsample_setNTs_ID103_adduct[M+H]+_tagWT_an4656.conf
      2: config/testsample_setNTs_ID105_adduct[M+H]+_tagAA_an5200.conf
                                                             f_log
      1: log/testsample_setNTs_ID103_adduct[M+H]+_tagWT_an4656.log
      2: log/testsample_setNTs_ID105_adduct[M+H]+_tagAA_an5200.log
                                                             f_spec
      1: spec/testsample_setNTs_ID103_adduct[M+H]+_tagWT_an4656.csv
      2: spec/testsample_setNTs_ID105_adduct[M+H]+_tagAA_an5200.csv
                                           stag
      1: setNTs_ID103_adduct[M+H]+_tagWT_an4656
      2: setNTs_ID105_adduct[M+H]+_tagAA_an5200
                                                         f_res
      1: testsample_setNTs_ID103_adduct[M+H]+_tagWT_an4656.csv
      2: testsample_setNTs_ID105_adduct[M+H]+_tagAA_an5200.csv

---

    Code
      x
    Output
          ID adduct tag   an CE                                   stag num_poss_IDs
      1: 103 [M+H]+  WT 4656 10 setNTs_ID103_adduct[M+H]+_tagWT_an4656            3
      2: 105 [M+H]+  AA 5200 10 setNTs_ID105_adduct[M+H]+_tagAA_an5200           68
         max_Score n_Score_GE4 n_Score_GE3 n_Score_GE2 Identifier
      1:  4.480685           1           1           1       7955
      2:  4.923373           1           1           1       6305
                                         CompoundName Max_FragmenterScore
      1:                1,3,5-triazine-2,4,6-triamine            183.2284
      2: (2S)-2-amino-3-(1H-indol-3-yl)propanoic acid            324.9085
         Max_OfflineIndividualMoNAScore Max_PubMed_Count Max_Patent_Count
      1:                        0.80635             1603            81511
      2:                        0.97504            41182           341244
         Max_AnnoTypeCount
      1:                 9
      2:                 9
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            All_Identifier
      1:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                7955;76318;3057066
      2: 6305;54459;3292;13596072;53613696;2764164;42281871;28808413;61307511;207696;68386764;14374492;732887;231558;259193;3064503;109115;6445208;3045196;65932;9588613;2034851;23510;54847133;6002761;91480;3086487;3086499;3087980;67218699;231964;755565;308071;206196;4344644;135436543;217642;98415;59833;3064824;907174;289049;138115391;937052;63733;89053;3032614;4444779;22348363;3054223;123963;98889;26433;97551;23511414;295571;4712703;135566968;3059780;12602;573861;91785;4255416;171417;10822054;7164635;239183;135454393

